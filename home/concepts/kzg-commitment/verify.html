<!--
title: verify
description: 
published: true
date: 2022-12-07T17:00:35.756Z
tags: 
editor: ckeditor
dateCreated: 2022-12-07T17:00:32.739Z
-->

<!--
title: KZG Part 3: Verify
description: 
published: true
date: 2022-12-03T05:09:47.761Z
tags: 
editor: undefined
dateCreated: 2022-12-03T05:09:25.310Z
-->

<figure class="image"><img src="/kzg-verify-1.jpeg"></figure>
<p style="text-align:center;"><i>This is part 3 of a 3 part series on KZG Commitments. Here are links to </i><a href="https://inevitableeth.com/home/concepts/kzg-commitment/commit"><i>part 1</i></a><i>, </i><a href="/home/concepts/kzg-commitment/open"><i>part 2</i></a><i> and the </i><a href="https://inevitableeth.com/home/concepts/kzg-commitment"><i>summary article</i></a><i>.</i></p>
<h1 style="text-align:center;">KZG Commitments Part 2: Open</h1>
<h2>Prerequisites</h2>
<h3>Elliptic Curve Cryptography</h3>
<p>Elliptic curve cryptography looks unapproachable, but it's totally understandable with a decent amount of high school algebra.&nbsp;</p>
<p>Check out this <a href="https://inevitableeth.com/home/concepts/elliptic-curve-cryptography">Into to Elliptic Curve Cryptography</a> and you'll have the math you need to get through this article.</p>
<h2>KZG Commitment Scheme</h2>
<p><a href="https://inevitableeth.com/home/concepts/polynomial-commitment">Deep Dive: Polynomial Commitment Schemes</a></p>
<p>A polynomial commitment scheme allows one party to publicly commit to a specific dataset without giving away any info about the underlying data.&nbsp;</p>
<p>Once a commitment has been calculated, the data is locked in; any changes to the data will result in invalid proof generation.</p>
<p>A KZG polynomial commit can be "opened" with any data point without revealing the entire dataset.&nbsp;</p>
<p>Let's say I am thinking of 10 words. I write them each down on different pieces of paper. If you guess correct, i ONLY show you the correct 1 (keeping the other 9 hidden).</p>
<h3>KZG Commitments Part 1: Commit</h3>
<figure class="image"><img src="/kzg-verify-2.jpeg"></figure>
<p><a href="https://inevitableeth.com/home/concepts/kzg-commitment/commit">Deep Dive: KZG Commitments Part 1 - Commit</a></p>
<p>First, we generate a polynomial from our data using a mathematical process called a Lagrange Interpolation.&nbsp;</p>
<p>Then, we calculate the value of this polynomial evaluated with a secret number S (hidden within an elliptic curve).</p>
<p>Once the commitment is calculated, the prover is bound to this specific data. The scheme is going to pivot around this specific value, derived from this specific polynomial.&nbsp;</p>
<p>A change to even a single bit will result in a brand new polynomial (and therefore commit value).</p>
<h3>KZG Commitments Part 2: Open</h3>
<figure class="image"><img src="/kzg-verify-3.png"></figure>
<p><a href="/home/concepts/kzg-commitment/open">Deep Dive: KZG Commitments Part 2 - Open</a></p>
<p>The verifier (the party challenging the prover) knows at least one piece of data in the committed data set, and so requests a proof around data point z. The prover calculates [h(S)] and f(z), returning the values to the verifier.</p>
<p>Just like our original commitment is simply f(x) evaluated through the elliptic curve at S, our proof is going to be an evaluation of h(x) at S... ALSO an elliptic curve point!&nbsp;</p>
<p>The question: how can we use our f(S), f(z), h(S) and z to prove our prover is being honest?</p>
<h2>Verifying the Quotient Polynomial</h2>
<p>The core of KZG commitment is this "h(x)" polynomial. If the prover is honest and is still committed to the original data, this is a simple polynomial to derive and to evaluate. And so, we are simply going to test this polynomial by having the prover evaluate it at S.</p>
<p>Remember, the verifier may or may not have access to the full original data set and therefore the verifier cannot build the polynomial and check the provers value. Instead, we are going to check a slightly different equation:</p>
<figure class="image"><img src="/kzg-verify-4.png"></figure>
<p>But remember, we aren't working with standard functions; we are working with elliptic curves.&nbsp;</p>
<p>And so, we have a problem.&nbsp;</p>
<p>We have seen that we can easily add and subtract two points on an elliptic curve, but we haven't seen multiplication.</p>
<h2>Elliptic Curve Pairings</h2>
<figure class="image"><img src="/kzg-verify-7.jpeg"></figure>
<p><a href="/home/concepts/elliptic-curve-pairings">Deep Dive: Elliptic Curve Pairings</a></p>
<p>In fact, you CAN'T multiply two elliptic curve points, at least in any coherent way... not in any way that will non-destructively obscure data in the way we need.&nbsp;</p>
<p>Fortunately, we have a solution: elliptic curve pairings.</p>
<p>Pairings are perhaps the most advanced math you'll ever come across. Super exciting, cutting edge research-type stuff.&nbsp;</p>
<p>For our purposes, they are actually pretty easy: imagine pairings as the single use, irreversible version of elliptic curve point multiplication.</p>
<h2>Verification</h2>
<figure class="image"><img src="/kzg-verify-6.jpeg"></figure>
<p>Now we have all the pieces we need to complete our KZG proof verification; let's finish creating verification conditions.&nbsp;</p>
<figure class="image"><img src="/kzg-verify-5.jpeg"></figure>
<p>At the end of this process we will have our KZG verification expression. All we need to is evaluate each side and make sure they are equivalent.</p>
<p>The prover supplies 3 of 4 terms needed in the verification expression:&nbsp;</p>
<ul>
  <li>[f(S)], the commitment to the data - [h(S)]</li>
  <li>a commitment to h(S), where h(x) is polynomial constructed around z - f(z)</li>
  <li>the original polynomial evaluated at z</li>
</ul>
<p>The verifier can calculate [S - z].</p>
<p>And so, the verifier computes both sides of the equation and compares the results. If the results match, then we can be mathematically certain the prover was honest!&nbsp;</p>
<p>Need to unpack that one more time?</p>
<p>The purpose of the verification is to work out whether the prover successfully divided the polynomial f(x) by (x-z). If any of the data was altered, the prover wont have access to f(x). He'll be able to generate a polynomial based off the new data, but it won't verify.</p>
<h2>Summary</h2>
<p>Think like this:&nbsp;</p>
<ul>
  <li>Step 1: the prover committed to a dataset by creating a polynomial and evaluating it using the SRS</li>
  <li>Step 2: the verifier challenges the prover by giving a data point within the original data set</li>
  <li>Step 3: the prover comes back with two items, a curve point chosen using the prover's requested data point and an evaluation</li>
  <li>Step 4: the prover uses a pairing to double check that these two items were correctly calculated, using the commitment as a reference.</li>
</ul>
<p>That's it, the entire KZG commitment scheme!&nbsp;</p>
<p>Once the verifier has run both sides of the equation and checked for equality, the process is complete.&nbsp;</p>
<p>We've successfully verified both the original commitment and the specific data point within the committed dataset.</p>
<h2>Resources</h2>
<p>Source Material - <a href="https://twitter.com/SalomonCrypto/status/1583542847759753217">Twitter Link</a></p>
<p>Source Material - <a href="/twitter-pdf-2022-10-21_kzg_verify.pdf">PDF</a></p>
