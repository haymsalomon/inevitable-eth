<!--
title: Finality
description: 
published: true
date: 2023-01-10T06:12:17.299Z
tags: 
editor: ckeditor
dateCreated: 2023-01-10T06:10:50.237Z
-->

<figure class="image"><img src="/finality-banner.png">
  <figcaption><a href="https://holon.investments/ethereum-check-in/"><i>source</i></a></figcaption>
</figure>
<h1 style="text-align:center;">Finality</h1>
<h2>The World Computer</h2>
<p>Ethereum is the <a href="https://inevitableeth.com/home/ethereum/world-computer">World Computer</a>, a single, globally shared computing platform that exists in the space between a network of 1,000s of computers (<a href="https://inevitableeth.com/home/ethereum/network/node">nodes</a>). These nodes are real computers in the real world, communicating directly from peer to peer.&nbsp;</p>
<p>The purpose of the greater Ethereum apparatus is to offer a single shared computing platform - the <a href="https://inevitableeth.com/home/ethereum/evm">Ethereum Virtual Machine</a> (EVM).</p>
<p>These nodes must stay perfectly in sync, processing the same <a href="/home/ethereum/blockchain/transaction">transactions</a> and doing the same actions that every other node is doing.</p>
<p>The way Ethereum coordinates and stays in sync is through a process called <a href="/home/ethereum/network/consensus/pos">Proof of Stake</a> (PoS).</p>
<h2>Byzantine Fault Tolerance</h2>
<p><a href="/home/concepts/bft">Deep Dive: The Byzantine General's Problem and Byzantine Fault Tolerance</a>&nbsp;</p>
<p>Ethereum's PoS system is built on a body of work called the Byzantine General's Problem.</p>
<p>Byzantine Fault Tolerance describes the ability to resist failures (and attacks) that don't provide clear, reliable data on whether the component has failed.</p>
<p>Practical Byzantine Fault Tolerance (pBFT) is an algorithm that efficiently solves the Byzantine General's Problem.</p>
<p>We can mathematically show that pBFT is both safe (honest participants can agree) and live (the system does not stall).</p>
<p>Tl;dr pBFT systems are built on a two-round system of voting; first, each participate votes on their proposed plan of action. Post-execution, they vote again.</p>
<p>It's after this second vote that pBFT guarantees that the group has irrevocably reached consensus.</p>
<h2>Ethereum PoS as pBFT</h2>
<p><a href="/home/ethereum/network/consensus/time">Deep Dive: Ethereum Time (Slots and Epochs)</a></p>
<p>At its core, Ethereum PoS looks like a pBFT system, based around two rounds of voting.</p>
<p>In PoS, we call each round of voting an epoch.</p>
<p>Every 12 seconds, Ethereum produces a new block, filling a slot. 32 slots = 1 epoch = 6.4 mins.</p>
<p>At the beginning of each epoch, the entire validator set is shuffled into 32 committees - one for each slot.</p>
<p>Over the next 32 slots, each committee will vote on the block proposed in its corresponding slot.</p>
<p>By the end of the epoch, every validator has voted 1 time.</p>
<p>This represents the first round of pBFT voting.</p>
<p>At this stage, we call blocks "justified," which they remained until they receive their second vote and become "finalized."</p>
<p>The second round happens during the next epoch.</p>
<p>As the epoch changes, the validators are reshuffled and the process begins again.</p>
<p>Each time a new transaction is entered into Ethereum, the transactions before it are explicitly accepted as canonical World Computer transactions.</p>
<p>By virtue of being explicitly voted on during their execution epoch and then implicitly voted on during the following epoch, every transaction on every block is voted on 2 times, fulfilling the requirements of pBFT.</p>
<p>And so, at this stage we call blocks "finalized."</p>
<h3>Finality</h3>
<p>Finality is an incredibly important concept in Ethereum. Once a transaction/block/epoch is finalized, it cannot be changed without a significant amount (&gt;1/3) of staked ETH being destroyed.</p>
<p>Once finalized, the transaction is permanent, guaranteed by the value of ETH.</p>
<p>To recap:</p>
<ul>
  <li>Start of epoch, all validators are split into 32 groups/committees</li>
  <li>Each committee votes on one block</li>
  <li>By end of epoch, all validators have voted once</li>
  <li>By end of next epoch, all validators have voted twice (fulfilling pBFT and finalizing the blocks)</li>
</ul>
<p>The net result of this system: Ethereum transactions cannot be considered final (and protected by the value of $ETH) until after at least 2 epochs (~13 mins).</p>
<p>For the record, this is still MUCH better than anything we have in trad-fi. But we can do better.</p>
<h2>Looking Forward</h2>
<p>More astute readers might have noticed the relationship between the number of committees we break the validators up into and the amount of time it takes to reach finality.</p>
<p>Consider 16 committees, instead of 32: epochs = 16 slots = 3.2 mins.</p>
<p>Finality in 6.4 mins.</p>
<p>In fact, the less committees we have, the less time it takes to achieve finality.</p>
<p>Unfortunately, getting every single validator to inspect, vote and finish preparing a block within the 12 second cadence is exceedingly difficult.</p>
<p>The biggest bottleneck is in the aggregation of the validator's <a href="/home/concepts/digital-signatures">digital signatures</a>.</p>
<p>Ethereum PoS validators use <a href="/home/concepts/bls-signatures">BLS signatures</a>, leveraging their very powerful ability to aggregate millions of signatures into a single key.</p>
<p><a href="https://beaconcha.in/">There are currently ~500k validators</a> actively participating in Ethereum PoS.</p>
<p>Each block needs to be signed by its committee, aggregated and finished within a slot or two. It's just not feasible to do the entire set every slot.</p>
<p>And so, 32 slots per epoch (and therefore 32 committees, ~13 mins to finality, even 32 $ETH per validator) are all determined by the logistical constraints imposed by the PoS system.</p>
<p>Improving BLS aggregation, stabilizing P2P networks, creating new voting structures... all of these are ways to drive Ethereum to its endgame:</p>
<p>Single-slot finality.</p>
<p>Instant, trustless settlement.</p>
<h2>Resources</h2>
<p>Source Material - Twitter Link</p>
