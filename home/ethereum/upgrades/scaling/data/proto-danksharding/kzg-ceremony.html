<!--
title: KZG Ceremony
description: 
published: false
date: 2022-12-12T02:18:58.475Z
tags: 
editor: ckeditor
dateCreated: 2022-12-11T16:35:48.536Z
-->

<p>&nbsp;</p>
<h1 style="text-align:center;">(Proto-) Danksharding KZG Trusted Setup</h1>
<h2>The World Computer</h2>
<p>Ethereum is the <a href="https://inevitableeth.com/home/ethereum/world-computer">World Computer</a>, a network of 1,000s of computers (<a href="https://inevitableeth.com/home/ethereum/network/node">nodes</a>) coordinating using <a href="https://inevitableeth.com/home/ethereum/network/consensus/pos">Proof of Stake</a> (PoS) to keep the <a href="https://inevitableeth.com/home/ethereum/evm">Ethereum Virtual Machine</a> (EVM) in sync.</p>
<p>The EVM is the shared computing platform, the blockchain its history and ETH its lifeblood.</p>
<p>This "network of nodes" is the foundation upon which Ethereum ultimately derives its value. The more decentralized, the more value.</p>
<p>From decentralization comes <a href="https://inevitableeth.com/home/concepts/credible-neutrality">credible neutrality</a>.&nbsp;</p>
<p>Without credible neutrality, we might as well be using FB-dollaroos in Farmville-DeFi.</p>
<h2>The Scaling Problem</h2>
<p>Today, Ethereum is SLOW, processing ~20-30 transactions per second.&nbsp;</p>
<p>Let's be frank, that is too slow for anything with the name “The World Computer,” <a href="https://www.un.org/en/desa/world-population-reach-8-billion-15-november-2022">we have &gt;8,000,000,000 people on this planet</a>.&nbsp;</p>
<p>We can easily increase the performance of Ethereum by simply increasing the minimum requirements of the nodes. The more powerful these computers are, the faster Ethereum can process transactions.</p>
<p>But here's the problem: the higher the minimum requirements of a node, the less people can participate in the network. Maybe the costs are too high, maybe the hardware is unavailable, maybe they don't have access to a reliable internet connection.</p>
<p>Any increases to minimum requirements for nodes inherently decreases the decentralization of the network.</p>
<p>And so, the naive approach to scaling is a dead end.</p>
<p>In fact, this concept is so well understood that we've created a cute little phrase: <a href="https://medium.com/logos-network/everything-you-know-about-the-scalability-trilemma-is-probably-wrong-bc4f4b7a7ef">the scalability trilemma</a>.</p>
<h2>The Settlement Layer of the Internet</h2>
<figure class="image"><img src="/scaling-1.jpeg"></figure>
<p><a href="/home/ethereum/upgrades/scaling">Deep Dive: Scaling Ethereum Execution</a></p>
<p>Fortunately, the gigabrains of Ethereum have come up with a solution, one that rejects the very framing of the scalability trilemma.&nbsp;</p>
<p>It starts with taking a huge step back: what is the purpose of Ethereum?</p>
<p>Yes, the EVM is <a href="/home/concepts/turing-complete">Turing-complete</a> <a href="/home/concepts/virtual-machine">virtual machine</a> and therefore capable of generalized <a href="/home/background/mass-comm/computer">computation</a>. We can think about turbo-charging the EVM until it can perform at the same level as a centralized platform (think <a href="https://aws.amazon.com/">AWS</a>), but we already have high performance computing.</p>
<p>And centralized computing will always be faster and easier than decentralized computing.</p>
<p>So, to think of Ethereum scaling as “how can we increase the World Computer's transaction throughput to be closer to someone like <a href="https://www.visa.co.uk/dam/VCOM/download/corporate/media/visanet-technology/aboutvisafactsheet.pdf">Visa</a>," is like designing a fighter jet and thinking "how can we increase its ground speed to be close to something like a <a href="https://www.youtube.com/watch?v=FuS_bXJNync">Bugatti Chiron</a>.</p>
<p>What's special about Ethereum is not that offers a generalized computing platform, it's that it offers a trustless, immutable platform.</p>
<p>The purpose of Ethereum is trustless <a href="/home/concepts/settlement">settlement</a>, not trustless computation.</p>
<h3>Rollups</h3>
<figure class="image"><img src="/scaling-execution.jpeg"></figure>
<p><a href="/home/ethereum/upgrades/scaling">Deep Dive: Rollups</a></p>
<p>Here's the idea: instead of asking Ethereum to do all the computation, we ask a much more specialized (much more centralized) entity to actually run the computation and simply post a record back to Etheruem.</p>
<p>Let's say I have 100 numbers I want to add up. Instead of asking Ethereum to actually do the addition, I can run the addition elsewhere and simply post the numbers and the result on-chain. Everyone can verify that the answer is correct, but the EVM itself doesn't have to run the computation.</p>
<p>This is the idea behind rollups, which are independent, high-performance blockchains that settle to Ethereum.</p>
<p>Rollups can support MANY more transactions MUCH faster, but because they post back to Ethereum, they inherent all of the decentralized properties of Etheruem.</p>
<p>The rollup paradigm scales the execution throughput of Ethereum by orders of magnitude, but we still have a problem. Rollups still need to post copies of the data and results to Ethereum.</p>
<p>If we don't scale the <a href="/home/ethereum/upgrades/scaling/data/data-availability-bottleneck">data availability</a> of Ethereum mainnet, then execution scaling becomes a solution to the problem we don't have.</p>
<h3>Danksharding</h3>
<p><a href="/home/ethereum/upgrades/scaling/data">Deep Dive: Danksharding</a></p>
<p>Fortunately, we have a solution: Danksharding (named after <a href="https://twitter.com/dankrad">Dankrad Feist</a>).</p>
<p>Danksharding creates a new Ethereum data structure tailor-made for rollups: a blob.&nbsp;</p>
<p>A blob is simply a huge, cheap storage container that cannot be accessed by the EVM.</p>
<p>Here's an analogy: imagine Ethereum is a train company and rollup data is cargo.</p>
<ul>
  <li>Before Danksharding, the cargo needed to go in the passenger cabin, paying passenger pricing.</li>
  <li>After, the cargo can go in its own separate car, but the train company can't monitor it.</li>
</ul>
<h4>Proto-Danksharding</h4>
<p><a href="https://inevitableeth.com/home/ethereum/upgrades/scaling/data/proto-danksharding">Deep Dive: Proto-Danksharding</a></p>
<p>Danksharding is a huge upgrade and needs to be approached in phases.</p>
<p>Phases 1 is Proto-Danksharding (named for <a href="https://twitter.com/protolambda">protolambda</a> and Danksharding), which will make the changes needed to support a single blob (per block) and create an independent <a href="https://inevitableeth.com/home/concepts/gas">gas</a> market just for blobs.</p>
<h2>The Roadmap to Scaled Ethereum</h2>
<p>Looking forward, the way to understand Ethereum scaling is to understand that Ethereum needs to settle more transactions (and not execute more computation). Rollups will offload computation, while Danksharding increases settlement bandwidth.</p>
<p>On the execution side, the vast majority of development happens outside of the Ethereum community, in the teams working on building high-performance, secure blockchains. As the paradigm evolves, <a href="https://ethereum-magicians.org/t/a-rollup-centric-ethereum-roadmap/4698">the Ethereum devs modify their roadmap to super-charge these efforts</a>, but its best to think of the energy of rollup development happening in the community.</p>
<p>On the other hand, Danksharding (and Proto-Danksharding) are core upgrades to the protocol itself. Not only is the research and development championed by the Ethereum Foundation, but the implementation will require deep changes to the core of Ethereum.</p>
<p>One of the more important reasons: Danksharding is built on KZG commitment scheme…</p>
<p>And a KZG commitment scheme requires a trusted setup.</p>
<h2>KZG Commitments</h2>
<figure class="image"><img src="/kzg-commitment-summary-1.jpeg"></figure>
<p><a href="/home/concepts/kzg-commitment">Deep Dive: KZG Commitments</a></p>
<p>KZG Commitments are a type of <a href="/home/concepts/commitment">cryptographic commitment scheme</a>. A commitment scheme is used to bind one party to a specific set of data. A commitment is a piece of data that doesn't reveal any information about the underlying data set, but can be used to prove specific things about it.</p>
<p>A KZG commitment has the special property that it can be “opened” (used to prove) an specific point of data in a dataset without revealing the whole thing.</p>
<p>Let's say I have 100 pieces of data, and you only know the 42nd. I could create a KZG commitment to my data and share it publicly. You could use the commitment to verify piece 42, but the scheme would not leak any additional information.</p>
<p>KZG commitments are critical to the Danksharding scheme, as they are the mechanism by which the <a href="/home/ethereum/upgrades/scaling/data/p2p-network/data-availability-sampling">network will sample the data</a>. For more information, see the <a href="/home/ethereum/upgrades/scaling/data">Danksharding deep dive</a>.</p>
<p>Although KZG commitments are some of the most advanced math out there, they are totally digestible to anyone with high school algebra. For our purposes, we don't even need to go that far. Here's all you need to know:</p>
<ul>
  <li>KZG commitments are an application of <a href="/home/concepts/elliptic-curve-cryptography">elliptic curve cryptography</a></li>
  <li>KZG commitments are a form of <a href="/home/concepts/polynomial-commitment">polynomial commitment</a>, meaning they <a href="/home/concepts/polynomial-encoding">transform an underlying dataset</a> into an equivalent mathematical formula</li>
  <li>Once the data has been transformed into a polynomial, we will evaluate it at a secret number. The polynomial will output a number that is indistinguishable from random data, but is unique to that dataset (commitment)</li>
  <li>Using more <a href="/home/concepts/elliptic-curve-pairings">elliptic curve cryptography</a>, any person can use the commitment to trustlessly open and verify the commitment (and therefore the underlying data)</li>
</ul>
<p>So here's the question:</p>
<p>How do we get a secret number?</p>
<h2>Elliptic Curve PCS Trusted Setup</h2>
<figure class="image"><img src="/pcs-trusted-setup-1.jpeg"></figure>
<p><a href="/home/concepts/pcs-trusted-setup">Deep Dive: PCS Trusted Setup</a></p>
<p>The answer: we generate a random number and hide it within an elliptic curve.</p>
<p>Understanding the trusted setup requires deeper dives on many of the topics we've already covered, but here's what you need to know:</p>
<ul>
  <li>we want to hide a secret number S</li>
  <li>we generate points by repeatedly multiplying S with itself and applying our elliptic curve function</li>
  <li>the specific points - related by S - are indistinguishable from random data</li>
  <li>the true value of S is destroyed and lost, forever</li>
</ul>
<p>The output of a trusted setup is a structured reference string (SRS), which contains the generated S<sup>i</sup> terms. These S<sup>i</sup> terms can be used to evaluate the polynomial of the data at point S without revealing anything about S itself.</p>
<p>This is called a trusted setup because it requires the system to trust that the actual value of S is lost forever. If an attacker has the true value of S, breaking the system becomes trivial.</p>
<h2>The Weakest Link</h2>
<p>At this point it is (hopefully) incredibly clear: Ethereum's value is in its decentralization and the trustless nature of the EVM.</p>
<p>The reality is that the entire system is only as strong as its weakest link.&nbsp;</p>
<p>This is the problem space we are entering: we need to implement KZG commitments (specifically create the SRS) without introducing a trust assumption into Ethereum.</p>
<p>Failure to implement KZG commitments means we need an entirely new scaling strategy.</p>
<p>Failure to implement them in a decentralized, untrusted way means we need an entirely new blockchain.</p>
<p>Fortunately, we already have a solution!</p>
<h2>Powers-of-Tau</h2>
<figure class="image"><img src="/kzg-ceremony-1.png">
  <figcaption><a href="https://vitalik.ca/general/2022/03/14/trustedsetup.html"><i>source</i></a></figcaption>
</figure>
<p><i>Note: Vitalik did a great writeup on trusted setups. If you want to </i><a href="https://vitalik.ca/general/2022/03/14/trustedsetup.html"><i>go straight to the source</i></a><i>, I understand.</i></p>
<p>The trusted setup is an example of <a href="https://en.wikipedia.org/wiki/Secure_multi-party_computation">multiparty computation</a>, which is a branch of computer science that looks into systems where multiple parties jointly compute a function over their inputs while keeping those inputs private.</p>
<p>This system is called a powers-of-tau setup (or ceremony).</p>
<p>We begin with a single participant, who generates an SRS. This participant is expected to throw away the secret number they used to generate it.</p>
<p>Then, the SRS is passed along to the next participant, who will generate their own secret number. The next participant will take the SRS and multiply each term by their new secret number. When finished, this participant is also expected to throw away their secret number.</p>
<p>The new SRS is based on two secret numbers, one from each participant. If either one destroys the secret number, the SRS will remain secure.</p>
<p>We've transformed our centralized trust assumption into a decentralized trust assumption.</p>
<p>The same process repeats over and over again. Each cycle will produce another SRS, indistinguishable from random data, but secretly tied together by each participant's secret number.</p>
<figure class="image"><img src="/kzg-ceremony-2.png">
  <figcaption><a href="https://vitalik.ca/general/2022/03/14/trustedsetup.html"><i>source</i></a></figcaption>
</figure>
<p>Anyone can use the intermediate outputs of the ceremony to recalculate the each SRS, but none of the outputs leak any information about any of the secret numbers.&nbsp;</p>
<p>A powers-of-tau setup is a 1 of N trust assumption, where N is the number of participants. The system is secure as long as one participant in the system does what they are supposed to do.&nbsp;</p>
<p>That’s where you come in!</p>
<h2>The Ethereum KZG Ceremony</h2>
<p>We are currently in the middle of the public contribution phase of the trusted setup needed for Ethereum Danksharding.</p>
<p>The Ethereum foundation has created a very easy-to-use tool for anyone to participate in the powers-of-tau ceremony and contribute random, secret data.&nbsp;</p>
<p>Then, you can delete your secret data forever.&nbsp;</p>
<p>From that moment on, you can sleep easy for the rest of your life knowing that the “trusted” setup is actually secure.&nbsp;</p>
<p>The only person you need to trust is yourself!</p>
<p>What’s more, you‘ll make Ethereum more secure for everyone. Remember, it’s a 1 of N trust assumption; everyone is more comfortable the bigger N is.</p>
<p>[walkthrough]</p>
<h2>Other Uses&nbsp;</h2>
<p>Here’s the cool thing about generating an SRS: once created, it can be used for any application that needs an SRS. It is not specific to Danksharding.&nbsp;</p>
<p>In fact, this SRS will be particularly useful. It will be long enough to support Danksharding blobs and will have a historic number of contributions.&nbsp;</p>
<p>And so, contributing to the Ethereum KZG ceremony will not have important implications for securing the World Computer, it will also secure an infinite number of future elliptic-curve-based applications.</p>
<p>But, unfortunately this SRS is only going to be useful for so long.&nbsp;</p>
<p>In fact, all SRSs are on a ticking clock.&nbsp;</p>
<h2>The End of the SRS</h2>
<p>Quantum computing has enormous implications on&nbsp;</p>
<p>&nbsp;</p>
